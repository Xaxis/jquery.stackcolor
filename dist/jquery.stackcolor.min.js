/*!
 * jquery.stackcolor
 * 
 * @author Wil Neeley <william.neeley@gmail.com> (https://github.com/Xaxis)
 * @version 1.0.0
 * @license MIT
 */
!function(a,b,c,d){"use strict";function e(b,c){this._name=f,this._defaults=g,this.element=b,this.options=a.extend({},g,c),this.init()}var f="stackcolor",g={onResult:function(){}};a.extend(e.prototype,{init:function(){var b,c=this,d=a(this.element),e=this.element.getBoundingClientRect(),f=a("[data-stackcolor]"),g=[];f.each(function(b,d){var f=a(d),h=f[0].getBoundingClientRect(),i=c.doElementsOverlap(e,h),j=f.attr("data-stackcolor");if(i){var k=c.getElementColors(f,j);g=g.concat(k)}}),b=this.calcColorAverages(g),this.options.onResult.call(this,b.rgb,b.hex,d)},doElementsOverlap:function(a,b){var c=a.y,d=a.y+a.height,e=a.x,f=a.x+a.width,g=b.y,h=b.y+b.height,i=b.x,j=b.x+b.width;return!(i>f||e>j||g>d||c>h)},getElementColors:function(b,c){var d=this,e=[this.rgb2hex(b.css("backgroundColor"))];return c&&a("*",b).each(function(b,c){d.doElementsOverlap(d.element.getBoundingClientRect(),c.getBoundingClientRect())&&e.push(d.rgb2hex(a(c).css("backgroundColor")))}),e},rgb2hex:function(a){var b=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"),c=function(a){return isNaN(a)?"00":b[(a-a%16)/16]+b[a%16]};return a=a.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),c(a[1])+c(a[2])+c(a[3])},calcColorAverages:function(a){for(var b=[],c=0,d=0,e=0,f=function(a){a=a.lastIndexOf("#")>-1?a.replace(/#/,"0x"):"0x"+a;var b=a>>16,c=(65280&a)>>8,d=255&a;return[b,c,d]},g=0;g<a.length;g++)b.push(f(a[g]));for(var h=0;h<b.length;h++){var i=b[h];c+=i[0],d+=i[1],e+=i[2]}var j=[Math.floor(c/b.length),Math.floor(d/b.length),Math.floor(e/b.length)],k="#"+this.rgb2hex("rgb("+j[0]+", "+j[1]+", "+j[2]+")");return{rgb:j,hex:k}}}),a.fn[f]=function(b){return this.each(function(){a.data(this,"plugin_"+f,new e(this,b))})}}(jQuery,window,document);